<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>MySQL 方法和操作 | Jast的博客</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="MySQL function and operator">
<meta property="og:type" content="article">
<meta property="og:title" content="MySQL 方法和操作">
<meta property="og:url" content="http://jast90.github.io/2019/04/17/MySQL-function-and-operator/index.html">
<meta property="og:site_name" content="Jast的博客">
<meta property="og:description" content="MySQL function and operator">
<meta property="og:locale">
<meta property="article:published_time" content="2019-04-17T07:14:00.000Z">
<meta property="article:modified_time" content="2021-02-09T05:54:02.830Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Jast的博客" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 5.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Jast的博客</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Suche"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Suche"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://jast90.github.io"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-MySQL-function-and-operator" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2019/04/17/MySQL-function-and-operator/" class="article-date">
  <time class="dt-published" datetime="2019-04-17T07:14:00.000Z" itemprop="datePublished">2019-04-17</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      MySQL 方法和操作
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="MySQL-方法和操作"><a href="#MySQL-方法和操作" class="headerlink" title="MySQL 方法和操作"></a>MySQL 方法和操作</h2><h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><p><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/5.7/en/func-op-summary-ref.html">MySQL 5.7 Function and Operator Reference</a></p>
<h3 id="方法应用小结"><a href="#方法应用小结" class="headerlink" title="方法应用小结"></a>方法应用小结</h3><h4 id="FIND-IN-SET"><a href="#FIND-IN-SET" class="headerlink" title="FIND_IN_SET()"></a>FIND_IN_SET()</h4><p>语法：FIND_IN_SET(str,strlist)<br>功能：Index (position) of first argument within second argument：返回第一个参数在第二个参数中的索引，从1开始</p>
<h4 id="BETWEEN-…-AND-…"><a href="#BETWEEN-…-AND-…" class="headerlink" title="BETWEEN … AND …"></a>BETWEEN … AND …</h4><p>语法：expr BETWEEN min AND max<br>功能：Check whether a value is within a range of values（判断一个值是否在范围内，在返回1，不在返回0<br>）</p>
<h4 id="GROUP-CONCAT"><a href="#GROUP-CONCAT" class="headerlink" title="GROUP_CONCAT()"></a>GROUP_CONCAT()</h4><p>语法：group_concat支持按字段连接、按字段排序，例如：<code>GROUP_CONCAT(a.exam_score_id ORDER BY a.</code>exam_score<code> DESC  SEPARATOR &quot;,&quot;)</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">GROUP_CONCAT([DISTINCT] expr [,expr ...]</span><br><span class="line">             [ORDER BY &#123;unsigned_integer | col_name | expr&#125;</span><br><span class="line">                 [ASC | DESC] [,col_name ...]]</span><br><span class="line">             [SEPARATOR str_val])</span><br></pre></td></tr></table></figure>
<p>功能：This function returns a string result with the concatenated non-NULL values from a group. It returns NULL if there are no non-NULL values. （返回按分组的、连接的非空字符串，如果不存在非NULL值返回NULL）</p>
<h4 id="SUBSTRING-INDEX"><a href="#SUBSTRING-INDEX" class="headerlink" title="SUBSTRING_INDEX()"></a>SUBSTRING_INDEX()</h4><p>语法：SUBSTRING_INDEX(str,delim,count)<br>功能：Returns the substring from string str before count occurrences of the delimiter delim. If count is positive, everything to the left of the final delimiter (counting from the left) is returned. If count is negative, everything to the right of the final delimiter (counting from the right) is returned. 在分隔符delim的计数出现之前，从字符串str返回子字符串。如果count为正数，则返回最终分隔符左侧的所有内容（从左侧开始计算）。如果count为负数，则返回最终分隔符右侧的所有内容（从右侧开始计算）。</p>
<h4 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h4><ol>
<li>查询分组下的前几名  </li>
<li>1 查询某场考试各班前三名成绩的学生信息  </li>
</ol>
<p>表结构如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE student(</span><br><span class="line">s_id INT(11) NOT NULL PRIMARY KEY AUTO_INCREMENT,</span><br><span class="line">s_name VARCHAR(64),</span><br><span class="line">c_id INT(11) NOT NULL</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">CREATE TABLE exam_score(</span><br><span class="line">exam_score_id INT(11) NOT NULL PRIMARY KEY AUTO_INCREMENT,</span><br><span class="line">exam_id INT(11),</span><br><span class="line">c_id INT(11) NOT NULL,</span><br><span class="line">s_id INT(11) NOT NULL,</span><br><span class="line">exam_score DECIMAL(13,2) NOT NULL</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p>方案1</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">  c.*,a.exam_score,a.exam_id</span><br><span class="line">FROM</span><br><span class="line">  (SELECT</span><br><span class="line">    *</span><br><span class="line">  FROM</span><br><span class="line">    &#96;exam_score&#96; a,</span><br><span class="line">    (SELECT</span><br><span class="line">      SUBSTRING_INDEX(</span><br><span class="line">        GROUP_CONCAT(</span><br><span class="line">          a.&#96;exam_score_id&#96;</span><br><span class="line">          ORDER BY a.&#96;exam_score&#96; DESC</span><br><span class="line">        ),</span><br><span class="line">        &quot;,&quot;,</span><br><span class="line">        3</span><br><span class="line">      ) AS exam_score_ids</span><br><span class="line">    FROM</span><br><span class="line">      &#96;exam_score&#96; a</span><br><span class="line">      LEFT JOIN &#96;student&#96; b</span><br><span class="line">        ON a.&#96;s_id&#96; &#x3D; b.&#96;s_id&#96;</span><br><span class="line">    GROUP BY b.&#96;c_id&#96;) AS b</span><br><span class="line">  WHERE FIND_IN_SET(</span><br><span class="line">      a.&#96;exam_score_id&#96;,</span><br><span class="line">      b.exam_score_ids</span><br><span class="line">    )) AS a</span><br><span class="line">  LEFT JOIN &#96;student&#96; c ON a.s_id &#x3D; c.&#96;s_id&#96;</span><br><span class="line">ORDER BY c.&#96;c_id&#96;,</span><br><span class="line">  a.&#96;exam_score&#96; DESC</span><br></pre></td></tr></table></figure>
<p>方案2</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"> SELECT</span><br><span class="line">  a.*</span><br><span class="line">FROM</span><br><span class="line">  &#96;exam_score&#96; a,</span><br><span class="line">  (SELECT</span><br><span class="line">    GROUP_CONCAT(</span><br><span class="line">      a.exam_score_id</span><br><span class="line">      ORDER BY a.&#96;exam_score&#96; DESC SEPARATOR &quot;,&quot;</span><br><span class="line">    ) AS exam_score_ids,</span><br><span class="line">    b.c_id AS c_id</span><br><span class="line">  FROM</span><br><span class="line">    &#96;exam_score&#96; a</span><br><span class="line">    LEFT JOIN &#96;student&#96; b</span><br><span class="line">      ON a.&#96;s_id&#96; &#x3D; b.&#96;s_id&#96;</span><br><span class="line">  GROUP BY b.&#96;c_id&#96;) AS b</span><br><span class="line">WHERE FIND_IN_SET(</span><br><span class="line">    a.&#96;exam_score_id&#96;,</span><br><span class="line">    b.exam_score_ids</span><br><span class="line">  ) BETWEEN 1</span><br><span class="line">  AND 3</span><br><span class="line">ORDER BY b.c_id ASC,</span><br><span class="line">  a.&#96;exam_score&#96; DESC;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://jast90.github.io/2019/04/17/MySQL-function-and-operator/" data-id="ckkxl9zs3000c1cnhfwcs16g8" data-title="MySQL 方法和操作" class="article-share-link">Teilen</a>
      
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2019/04/26/CenOS-install-docker-CE-and%20docker-compose/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Neuer</strong>
      <div class="article-nav-title">
        
          centos 安装docker CE
        
      </div>
    </a>
  
  
    <a href="/2018/11/30/Java-HashMap/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Älter</strong>
      <div class="article-nav-title">Java HashMap涉及的数据结构及实现</div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archiv</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">May 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">October 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">August 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">July 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">May 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">April 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">November 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">August 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">July 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">June 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">November 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/05/">May 2016</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">letzter Beitrag</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2020/05/16/2020-5-16-%E7%BC%93%E5%AD%98%E9%9B%AA%E5%B4%A9%E3%80%81%E7%A9%BF%E9%80%8F%E3%80%81%E5%87%BB%E7%A9%BF/">缓存雪崩、穿透、击穿</a>
          </li>
        
          <li>
            <a href="/2020/05/07/2020-5-7-heap-sort/">堆排序</a>
          </li>
        
          <li>
            <a href="/2019/10/26/Think-in-Java-ThreadPoolExecutor/">Java ThreadPoolExecutor 源码分析</a>
          </li>
        
          <li>
            <a href="/2019/08/02/Think-in-cglib-proxy/">Cglib 动态代理使用及深入</a>
          </li>
        
          <li>
            <a href="/2019/08/02/Kubernetes-install-and-nginx-example/">kubernetes minikube安装和运行nginx实例</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2021 John Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>