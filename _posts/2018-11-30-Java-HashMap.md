---
layout: bootstrap
title: 'Java HashMap涉及的数据结构及实现'
description: 'Data structure of Java HashMap'
date: '2018-11-30 16:40:00'
author: Jast
---
# Java HashMap涉及的数据结构及实现
## 提供的功能
- 基于哈希表实现的Map;
- 非线程安全的Map实现；
- 键和值都可以为null(因为有处理null的情形)；
- 基本操作`get()`和`put()`的时间消耗是固定的；
- 数据存储结构会随着HashMap的数量而变换成不同的数据结构。

## 涉及到的概念
- 默认初始化容量
- 最大容量
- 默认的负载系数（load factor）
- 树形化的阈（yù）值
- 非树形化的阈值
- 最小树形化的容量


## 涉及的基本概念
- 单链表
- 红-黑树
- 链表、红-黑树互转

## 加入一个元素的过程
1、判断哈希表是否为空，是空的话先初始化哈希表
2、根据key算出该key在哈希表中存放的位子下标，判断该位置上是否存在结点
2.1、不存在的话就创建一个单链表结点存放该键值对
2.2、存在的话就判断已有结点的键是否是相同
2.2.1、键相同时，就把原结点取出，并将该结点的换成新值的单链表结点，并返回旧值
2.2.2、键不相同时，即产生哈希冲突，判断当前结点是否是红黑树结点
2.2.2.1、是红黑树结点的话，将键值对存入相应的树结点
2.2.2.2、不是红黑树结点，遍历链表，判断键是否存在
2.2.2.2.1、键存在的话就取出旧结点，返回旧值，新值
2.2.2.2.2、键不存在，新建单链表结点链接到到链表尾结点，并判断该链表的结点数量是否达到链表转换成树的阈值了，是的话将该链表转换成很黑树存储
2.2.2.3、元素加入后，判断map中键值对个数是否达到元素数量的阈值，达到的话就rehash一次